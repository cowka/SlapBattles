local DrRayLibrary = loadstring(game:HttpGet("https://raw.githubusercontent.com/AZYsGithub/DrRay-UI-Library/main/DrRay.lua"))()   
local window = DrRayLibrary:Load("Slap Royale", "Default")

local replicatedStorage = game:GetService("ReplicatedStorage")
local wsEvent = replicatedStorage.Events:FindFirstChild("WS")
local ws2Event = replicatedStorage.Events:FindFirstChild("WS2")

if wsEvent then
    wsEvent:Destroy()
end

if ws2Event then
    ws2Event:Destroy()
end

local mainTab = DrRayLibrary.newTab("Main", "rbxassetid://138370571957916")

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Connect(function(char)
    Character = char
end)
local Camera = workspace.CurrentCamera

local function playClickSound()
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://6324790483"
    sound.Parent = workspace
    sound:Play()
    sound.Ended:Connect(function()
        sound:Destroy()
    end)
end

local function removeRemoteEvent()
    local eventsFolder = ReplicatedStorage:FindFirstChild("Events")
    if eventsFolder then
        local busJumpingEvent = eventsFolder:FindFirstChild("BusJumping")
        if busJumpingEvent and busJumpingEvent:IsA("RemoteEvent") then
            busJumpingEvent:Destroy()
        end
    end
end

local function setTransparency()
    if Character then
        for _, part in ipairs(Character:GetDescendants()) do
            if part:IsA("BasePart") then
                if part.Name == "HumanoidRootPart" then
                    part.Transparency = 1
                else
                    part.Transparency = 0
                end
            elseif part:IsA("Decal") then
                part.Transparency = 0
            end
        end
    end
end

local function resetCamera()
    if Character and Character:FindFirstChild("Humanoid") and Character:FindFirstChild("HumanoidRootPart") then
        Camera.CameraSubject = Character.Humanoid
    end
end

local function unlockCamera()
    Player.CameraMinZoomDistance = 0
    Player.CameraMaxZoomDistance = 9999
end

local function removeWeldsFromBusModel()
    local busModel = workspace:FindFirstChild("BusModel")
    if busModel and busModel:IsA("Model") then
        for _, weld in ipairs(busModel:GetDescendants()) do
            if weld:IsA("Weld") then
                weld:Destroy()
            end
        end
    end
end

local function removeJumpPrompt()
    local jumpPrompt = Player.PlayerGui:FindFirstChild("JumpPrompt")
    if jumpPrompt then
        jumpPrompt:Destroy()
    end
end

local function removeCamPart()
    local camPart = workspace:FindFirstChild("CamPart")
    if camPart then
        camPart:Destroy()
    end
end

local function createNoCollisionBetweenParts(part1, part2)
    for _, constraint in pairs(part1:GetChildren()) do
        if constraint:IsA("NoCollisionConstraint") and constraint.Part1 == part2 then
            return
        end
    end
    local noCollision = Instance.new("NoCollisionConstraint")
    noCollision.Part0 = part1
    noCollision.Part1 = part2
    noCollision.Parent = part1
end

local function noCollideWithPlayer(otherPlayer)
    if not Player.Character or not otherPlayer.Character then return end
    for _, myPart in pairs(Player.Character:GetChildren()) do
        if myPart:IsA("BasePart") then
            for _, otherPart in pairs(otherPlayer.Character:GetChildren()) do
                if otherPart:IsA("BasePart") then
                    createNoCollisionBetweenParts(myPart, otherPart)
                end
            end
        end
    end
end

local function setupNoCollideForAllPlayers()
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= Player then
            noCollideWithPlayer(p)
        end
    end
end

Players.PlayerAdded:Connect(function(p)
    noCollideWithPlayer(p)
end)

-- Отключаем коллизии при загрузке скрипта
setupNoCollideForAllPlayers()

local hiddenfling = false
local flingThread = nil

local function fling()
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local RunService = game:GetService("RunService")
    local Players = game:GetService("Players")
    local lp = Players.LocalPlayer
    local c, hrp, vel, movel = nil, nil, nil, 0.1
    while hiddenfling do
        RunService.Heartbeat:Wait()
        c = lp.Character
        hrp = c and c:FindFirstChild("HumanoidRootPart")
        if hrp then
            vel = hrp.Velocity
            hrp.Velocity = vel * 100 + Vector3.new(5, 5, 5)
            RunService.RenderStepped:Wait()
            hrp.Velocity = vel
            RunService.Stepped:Wait()
            hrp.Velocity = vel + Vector3.new(0, movel, 0)
            movel = -movel
        end
    end
end

mainTab.newButton("Invisible", "Use In Bus | You cant Slap, But can be slapped.", function()
    playClickSound()
    removeRemoteEvent()
    unlockCamera()
    setTransparency()
    resetCamera()
    removeWeldsFromBusModel()
    removeJumpPrompt()
    removeCamPart()
end)

mainTab.newToggle("Touch Fling", "You Might Die, But Low Chance", false, function(toggleState)
    playClickSound()
    if toggleState then
        hiddenfling = true
        flingThread = coroutine.create(fling)
        coroutine.resume(flingThread)
    else
        hiddenfling = false
    end
end)

mainTab.newButton("Unnamed Fling", "Loads The UnNamed Fling Script | Good For This Game", function()
    playClickSound()
    loadstring(game:HttpGet('https://raw.githubusercontent.com/cowka/UnNamedFling/refs/heads/main/UnNamedFling'))() 
end)

mainTab.newSlider("Walk Speed", "", 100, false, function(num)
    if Character then
        local humanoid = Character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = num
        end

        local walkSpeedValue = Character:FindFirstChild("WalkSpeed") or Instance.new("IntValue", Character)
        walkSpeedValue.Name = "WalkSpeed"
        walkSpeedValue.Value = num
    end
end)

mainTab.newSlider("Jump Power", "", 150, false, function(num)
    if Character then
        local humanoid = Character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.JumpPower = num
        end

        local jumpPowerValue = Character:FindFirstChild("JumpPower") or Instance.new("IntValue", Character)
        jumpPowerValue.Name = "JumpPower"
        jumpPowerValue.Value = num
    end
end)

local miscTab = DrRayLibrary.newTab("Misc", "rbxassetid://116111718611543")
miscTab.newButton("Delete Acid", "Just Deletes Acid", function()
    playClickSound()
    local acidAbnormality = workspace.Map.AcidAbnormality
    if acidAbnormality then
        local acidPart = acidAbnormality:GetChildren()[26]
        if acidPart and acidPart:IsA("BasePart") then
            acidPart:Destroy()
        end
    end
end)

miscTab.newButton("Delete Lava", "Just Deletes Lava", function()
    playClickSound()
    local lavaPart = workspace.Map.DragonDepths.Lava
    if lavaPart then
        lavaPart:Destroy()
    end
end)

miscTab.newButton("Delete Lab", "Just Deletes The Whole Lab Folder", function()
    playClickSound()
    local labFolder = workspace.Map.OriginOffice
    if labFolder then
        labFolder:Destroy()
    end
end)

miscTab.newButton("TP To Zone", "Teleports you into center of zone", function()
    playClickSound()
    local zone = workspace:FindFirstChild("Zone1")
    if zone and zone:IsA("BasePart") then
        if Character and Character:FindFirstChild("HumanoidRootPart") then
            Character.HumanoidRootPart.CFrame = zone.CFrame + Vector3.new(0, 5, 0)
        end
    end
end)
